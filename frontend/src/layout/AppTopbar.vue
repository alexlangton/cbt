<script setup>
    import { useLayout } from '@/layout/composables/layout';
    import { useFiltersStore } from '@/stores/filtersStore';
    import { useMapStore } from '@/stores/mapStore';
    import { computed, ref, watch } from 'vue'; // Asegúrate de importar ref y computed
    import { useRouter } from 'vue-router';
    import AppConfigurator from './AppConfigurator.vue';

    const visibleRight = ref(false);

    const router = useRouter();
    const { onMenuToggle, toggleDarkMode, isDarkTheme } = useLayout();

    // Crear una instancia del store de filtros
    const filtersStore = useFiltersStore();

    const parkingsSeleccionados = computed(
        () => filtersStore.parkingsSeleccionados
    );
    const pluginsSeleccionados = computed(
        () => filtersStore.pluginsSeleccionados
    );
    const rangoSeleccionado = computed(() => filtersStore.rangoSeleccionado);
    const filtraPorFechaDe = computed(() => filtersStore.filtraPorFechaDe);

    // Propiedad computada para verificar si hay valores seleccionados
    const hayValoresSeleccionados = computed(() => {
        const rangoValido =
            Array.isArray(rangoSeleccionado.value) &&
            rangoSeleccionado.value.length === 2 &&
            rangoSeleccionado.value[0] !== null &&
            rangoSeleccionado.value[1] !== null;

        return (
            (parkingsSeleccionados.value &&
                parkingsSeleccionados.value.length > 0) ||
            (pluginsSeleccionados.value &&
                pluginsSeleccionados.value.length > 0) ||
            rangoValido
        );
    });

    watch(rangoSeleccionado, (newVal) => {
        console.log('rangoSeleccionado in AppTopbar.vue changed to:', newVal);
    });

    // Función para enviar datos al backend
    const enviarDatosAlBackend = async () => {
        const preferenciasPanel = JSON.parse(
            localStorage.getItem('preferenciasPanel')
        );
        const datosInicioSesion = JSON.parse(
            localStorage.getItem('datosInicioSesion')
        );

        if (preferenciasPanel && datosInicioSesion) {
            try {
                // Construir la URL dinámica con el email
                const url = `http://localhost/api/usuario/guardarPreferenciasPanel/${encodeURIComponent(datosInicioSesion.email)}`;

                console.log(url);

                // Hacer una solicitud POST al backend
                await axios.put(url, preferenciasPanel, {
                    headers: {
                        'Content-Type': 'application/json'
                    }
                });
                console.log('Datos enviados con éxito al backend.');
            } catch (error) {
                console.error('Error al enviar datos al backend:', error);
            }
        }
    };

    // Función para redirigir al login de la app después de enviar los datos
    const redirigirALogin = async () => {
        await enviarDatosAlBackend(); // Enviar los datos al backend antes de redirigir
        // Borrar datos del localStorage después de que se envíen con éxito
        localStorage.removeItem('token');
        localStorage.removeItem('datosSeleccionados');
        console.log('Datos eliminados del localStorage');
        router.push('/'); // Redirigir a la ruta de inicio de sesión ('/')
    };

    // Función para formatear las fechas al formato dd/mm/yyyy
    const formatearFechas = (fechas) => {
        return fechas
            .map((fecha) => {
                const date = new Date(fecha); // Convierte a objeto Date
                const day = String(date.getDate()).padStart(2, '0'); // Día
                const month = String(date.getMonth() + 1).padStart(2, '0'); // Mes (0-indexado)
                const year = date.getFullYear(); // Año
                const hours = String(date.getHours()).padStart(2, '0'); // Horas
                const minutes = String(date.getMinutes()).padStart(2, '0'); // Minutos

                // Formato dd/mm/yyyy hh:mm
                return `${day}/${month}/${year} ${hours}:${minutes}`;
            })
            .join(' - '); // Une las fechas con un guion
    };

    // Función para formatear la fecha de filtrado
    const formatearFiltradoFechas = (tipo) => {
        switch (tipo) {
            case 'Salida':
                return 'hora de salida';
            case 'Entrada':
                return 'hora de entrada';
            case 'EntradaYSalida':
                return 'hora de entrada y salida';
            default:
                return 'Tipo no válido';
        }
    };

    // Obtener el store del mapa
    const mapStore = useMapStore();

    // Computed para el estado de la leyenda
    const showLegend = computed(() => mapStore.showLegend);

    // Función para alternar la leyenda
    const toggleLegend = () => {
        mapStore.toggleLegend();
    };
</script>

<template>
    <Drawer
        v-model:visible="visibleRight"
        header="Información"
        position="right"
    >
        <ul style="font-family: 'Lucida Console', Monaco, monospace">
            <li style="margin-bottom: 1em">
                <strong>Parkings seleccionados:</strong>
                <ul style="margin-top: 0.5em">
                    <li
                        v-for="(parking, index) in parkingsSeleccionados"
                        :key="index"
                    >
                        {{ parking.name }} (Código: {{ parking.code }})
                    </li>
                </ul>
            </li>

            <!-- Separador entre Parkings y Plugins -->
            <hr style="border: 1px solid #ccc; margin: 1.5em 0" />

            <li style="margin-bottom: 1em">
                <strong>Plug-ins seleccionados:</strong>
                <ul style="margin-top: 0.5em">
                    <li
                        v-for="(plugin, index) in pluginsSeleccionados"
                        :key="index"
                    >
                        {{ plugin.name }} (Código: {{ plugin.code }})
                    </li>
                </ul>
            </li>

            <!-- Separador entre Plugins y Rango Seleccionado -->
            <hr style="border: 1px solid #ccc; margin: 1.5em 0" />

            <li style="margin-bottom: 1em">
                <strong>Rango Seleccionado:</strong>
                {{ formatearFechas(rangoSeleccionado) }}
            </li>

            <!-- Separador entre Rango Seleccionado y Filtrado -->
            <hr style="border: 1px solid #ccc; margin: 1.5em 0" />

            <li style="margin-bottom: 1em">
                <strong>Filtrado por</strong>
                {{ formatearFiltradoFechas(filtraPorFechaDe) }}
            </li>
        </ul>
    </Drawer>

    <div class="layout-topbar">
        <div class="layout-topbar-logo-container">
            <button
                class="layout-menu-button layout-topbar-action"
                @click="onMenuToggle"
            >
                <i class="pi pi-bars"></i>
            </button>
            <router-link to="/" class="layout-topbar-logo">
                <svg
                    width="42"
                    height="40"
                    version="1.1"
                    viewBox="0 0 11.112 10.583"
                    xmlns="http://www.w3.org/2000/svg"
                >
                    <g style="fill: var(--primary-color)">
                        <g
                            transform="matrix(.27428 0 0 .24827 .26458 .048256)"
                            style="fill: var(--primary-color)"
                        >
                            <path
                                d="m11.144 11.897h1.0228q0.15642 0.94954-0.02405 1.7762-0.18049 0.82665-0.68587 1.6086-0.37301 0.58089-0.92652 0.99422-0.54147 0.41333-1.1912 0.68143-0.64977 0.25693-1.3597 0.36864-0.70993 0.12288-1.4078 0.12288-1.468 0-2.7074-0.56972-1.2273-0.56972-2.2862-1.5528-0.40911-0.37982-0.67383-0.96071-0.26472-0.58089-0.43318-1.2288-0.15643-0.65909-0.24065-1.2958-0.072192-0.64792-0.096263-1.1506-0.024051-0.46918-0.084233-0.91602-0.060162-0.45801-0.048132-0.91602 0.024051-0.83783 0.1083-1.6421 0.084233-0.81548 0.30082-1.5975 0.22862-0.78197 0.61367-1.5081 0.38505-0.72612 0.99872-1.3964 0.31285-0.33513 0.61367-0.64792 0.31285-0.32396 0.734-0.58089 0.63774-0.37981 1.3236-0.49152 0.68587-0.12288 1.4319-0.12288 1.1311 0.011169 2.1418 0.36864 1.0228 0.35747 1.9613 0.94954 0.79416 0.5027 1.2033 1.1953 0.42115 0.68143 0.67383 1.4857 0.12033 0.37981 0.21659 0.75963 0.1083 0.36864 0.24066 0.78197-0.07219 0.055853-0.16846 0.067022-0.09626 0.011178-0.20456 0.011178-0.15643 0-0.31285 0.022329-0.14439 0.022329-0.26472 0.17874-0.0361 0.044685-0.09626 0.044685-0.1083 0-0.25269-0.12288-0.1444-0.12288-0.20456-0.31279-0.072192-0.24576-0.13236-0.49152-0.060162-0.24576-0.12033-0.50269-0.16846-0.62558-0.48131-1.0948-0.31285-0.46918-0.75806-0.80431-0.44521-0.3463-0.99872-0.56972-0.54147-0.23459-1.1792-0.37981-0.096263-0.022347-0.21659-0.033516-0.10829-0.011169-0.21659-0.033516-0.22862-0.067022-0.44521-0.089369-0.21659-0.033516-0.43318-0.033516-0.52944 0-1.0228 0.17874-0.48131 0.16756-0.97465 0.49152-0.52944 0.3463-0.81823 0.78197-0.27675 0.43567-0.48131 0.94954-0.39708 0.98305-0.6618 1.9884-0.26472 1.0054-0.36098 2.0443-0.084233 0.90485-0.084233 1.8097 0 0.89368 0.20455 1.7985 0.24065 1.0277 0.86636 1.7762 0.63774 0.74846 1.6605 1.1171 0.30082 0.11171 0.6257 0.16756 0.33692 0.05585 0.67383 0.0782 0.33692 0.02233 0.68587 0.03351 0.34895 0 0.68586 0.02233 0.1083 0.01118 0.20456 0.01118 0.10829 0 0.20456 0 0.50537 0 0.99872-0.0782 0.49334-0.0782 0.96262-0.2681 0.42114-0.15639 0.68586-0.48035 0.26472-0.32396 0.40911-0.71494 0.18049-0.48035 0.30082-0.98305 0.13236-0.51387 0.30082-1.0948z"
                                style="
                                    fill: var(--primary-color);
                                    white-space: pre;
                                "
                            />
                            <path
                                d="m16.475 5.7419q0.49334-0.10054 0.77009-0.10054 0.24066 0 0.37301 0.078191 0.14439 0.067022 0.21659 0.21225 0.08423 0.14522 0.12033 0.36864 0.04813 0.22342 0.08423 0.52504 0.09626 0.62558 0.09626 1.2512t-0.01204 1.2623q0 0.52504-0.0361 1.0501-0.0361 0.51387-0.06016 1.0389-0.02405 0.50269-0.06016 0.99422-0.0361 0.48035-0.06016 0.98305-0.02405 0.52504-0.02405 1.0501 0.01204 0.51387 0.01204 1.0501v1.6645q-0.24066 0.05585-0.46928 0.10054-0.21659 0.04468-0.45724 0.04468-0.34895 0-0.67383-0.15639 0.04813-2.8709 0.08423-5.7084 0.04813-2.8374 0.09626-5.7084zm-0.6618-4.2003q0.31285-0.055853 0.6618-0.12288 0.34895-0.0782 0.6979-0.10054 0.33692 0 0.44521 0.11171 0.1083 0.11171 0.1083 0.4245v1.4522q-0.27675 0.022338-0.52944 0.033516-0.25269 0.011169-0.49334 0.033516-0.08423 0.011169-0.15642 0.022338-0.06016 0-0.12033 0-0.30082 0-0.40911-0.14522-0.09626-0.14522-0.09626-0.5027-0.01204-0.25693-0.04813-0.53621-0.02405-0.29045-0.06016-0.67026z"
                                style="
                                    fill: var(--primary-color);
                                    white-space: pre;
                                "
                            />
                            <path
                                d="m26.654 16.243 0.12033 0.86017q-0.36098 0.29045-0.74603 0.41333-0.38505 0.13405-0.78213 0.13405-0.19252 0-0.38505-0.03352-0.19252-0.02233-0.39708-0.0782-1.1311-0.27927-1.7086-0.98305-0.56554-0.71494-0.60164-1.8097-0.02405-0.70377-0.02405-1.3964 0.01204-0.70378 0.02405-1.4075 0.02405-0.99422 0.0361-1.9773 0.01204-0.99422 0.0361-1.9996 0.01204-0.2681 0-0.54738 0-0.29045 0-0.63675-0.30082-0.022329-0.6257-0.022329-0.31285-0.011178-0.6257-0.055854-0.19252-0.022329-0.38505-0.0782-0.19252-0.055854-0.36098-0.15639-0.20456-0.13405-0.24066-0.33513-0.02405-0.21225 0.0361-0.43567 0.06016-0.22342 0.20456-0.32396 0.15642-0.10054 0.37301-0.10054 0.15643-0.011178 0.31285-0.011178 0.15643 0 0.31285 0h0.91449q0.16846-0.73729 0.13236-1.4411-0.0361-0.71494-0.22862-1.4187 0.20456-0.16757 0.40911-0.22342 0.21659-0.067022 0.45724-0.067022 0.15643 0 0.31285 0.022347 0.16846 0.022347 0.33692 0.044685 0.08423 0.37981 0.09626 0.75963 0.02405 0.36864 0.01204 0.75963 0 0.37982-0.01204 0.7708 0 0.37981 0.0361 0.7708h2.575q0.02405 0.17874 0.06016 0.35747 0.0361 0.16756 0.06016 0.33513 0.0361 0.16756 0.02405 0.33513-0.01204 0.16756-0.09626 0.35747-0.61367 0.044685-1.2273 0.089369-0.61367 0.033516-1.2995 0.0782 0 0.33513 0 0.64792 0.01204 0.31279 0 0.62558-0.02405 1.1171-0.07219 2.223-0.0361 1.0948-0.0361 2.2119 0 0.53621 0.09626 1.1953 0.1083 0.65909 0.38505 1.24 0.27676 0.56972 0.74603 0.96071 0.48131 0.39098 1.2273 0.39098 0.12033 0 0.25269-0.01118 0.13236-0.01118 0.26472-0.03352z"
                                style="
                                    fill: var(--primary-color);
                                    white-space: pre;
                                "
                            />
                            <path
                                d="m29.41 21.013q0.33692-0.05585 0.6618-0.11171 0.33692-0.04469 0.6618-0.13405 0.1083-0.02233 0.21659-0.11171 0.12033-0.0782 0.19252-0.16757 0.45724-0.6144 0.91449-1.2176 0.45724-0.60324 0.85432-1.24 0.25269-0.41333 0.22862-0.86017-0.01204-0.44684-0.26472-0.91602-0.38505-0.75963-0.72196-1.5304-0.32488-0.78197-0.64977-1.5639-0.64977-1.5639-1.2875-3.1167-0.63774-1.5639-1.2875-3.1279-0.072197-0.18991-0.19252-0.36864-0.10829-0.18991-0.24066-0.44684 0 0.011178-0.06016-0.12288-0.04813-0.14522 0.02405-0.30162 0.12033-0.25693 0.28879-0.35747 0.16846-0.11171 0.45724-0.11171 0.13236 0 0.30082 0.022329 0.18049 0.022329 0.38505 0.055853 0.96262 2.5023 1.9252 5.0158 0.97465 2.5135 1.9854 5.1498 0.30082-0.78197 0.56554-1.4411 0.27675-0.67026 0.51741-1.3405 0.57757-1.698 1.1311-3.3736 0.56554-1.6757 1.1431-3.3736 0.16846-0.45801 0.31285-0.6144 0.14439-0.16757 0.51741-0.16757 0.10829 0 0.25269 0.011178 0.14439 0.011178 0.31285 0.033516 0 0.18991 0.02405 0.40216 0.02405 0.21225-0.0361 0.40216-0.25269 0.91602-0.52944 1.832-0.26472 0.90485-0.55351 1.8097-0.16846 0.5027-0.38505 0.97188-0.21659 0.45801-0.39708 0.96071-0.39708 1.0612-0.78213 2.1225-0.37302 1.0612-0.75806 2.1225-0.13236 0.33513-0.31285 0.65909-0.16846 0.32396-0.31285 0.64792-0.24065 0.52504-0.46928 1.0389-0.21659 0.52504-0.45724 1.0612-0.0361 0.0782-0.06016 0.16756-0.01204 0.08937-0.0361 0.17874-0.40911 1.2735-1.3838 1.9438-0.97465 0.68143-2.3945 0.68143-0.25269 0-0.37302-0.05585-0.12033-0.05585-0.15642-0.18991-0.02405-0.13405 0.03609-0.36864 0.07219-0.22342 0.19252-0.55855z"
                                style="
                                    fill: var(--primary-color);
                                    white-space: pre;
                                "
                            />
                        </g>
                        <g
                            transform="matrix(.17387 0 0 .2709 -12.813 -1.2682)"
                            style="fill: var(--primary-color)"
                        >
                            <path
                                d="m83.982 32.37q0.5085 0.13642 0.91777 0.42168 0.42168 0.27285 0.71934 0.65732 0.29766 0.38447 0.48369 0.85576 0.18603 0.45889 0.22324 0.96738 0.07441 0.80615-0.02479 1.5875-0.08682 0.76895-0.22324 1.5379-0.06201 0.33486-0.28526 0.65732-0.21084 0.31006-0.43408 0.59531-0.24805 0.31006-0.55811 0.58291-0.29766 0.26045-0.57051 0.5457-0.23564 0.24805-0.5085 0.33486-0.27285 0.07441-0.58291 0.07441-0.31006 0.01241-0.60771 0.06201-0.29766 0.03721-0.59531 0.06201-0.5457 0.04961-1.0914 0.07441-0.5333 0.03721-1.079 0.09922-0.28525 0.02479-0.58291 0.03721-0.29766 0.02479-0.60772 0.02479-0.70693 0-1.4139-0.03721-0.70693-0.03721-1.3395-0.06201-0.14883 0-0.23564-0.5457-0.08682-0.55811-0.13643-1.3891-0.03721-0.83096-0.03721-1.7983 0-0.97978 0-1.8231 0.01241-0.85576 0.02479-1.4387 0.02479-0.58291 0.02479-0.63252-0.03721-1.4263-0.07441-2.8277-0.03721-1.4015-0.07441-2.8153-0.02479-0.90537-0.04961-1.7983-0.02479-0.90537-0.04961-1.7983 0-0.27285 0.01241-0.43408t0.08682-0.24805q0.08682-0.08682 0.24805-0.11162 0.16123-0.03721 0.44648-0.06201 0.71934-0.06201 1.4387-0.13642 0.71934-0.07441 1.4511-0.07441 0.12402 0 0.24805 0.0124 0.12402 0 0.24805 0 0.96738 0.06201 1.9224 0.21084 0.95498 0.14883 1.8852 0.37207 0.69453 0.17363 1.1782 0.68213 0.49609 0.49609 0.83096 1.1534 0.33486 0.65732 0.5333 1.3891 0.21084 0.71934 0.33486 1.3395 0.06201 0.33486-0.06201 0.73174-0.12402 0.39688-0.34727 0.80615-0.22324 0.39688-0.50849 0.78135-0.28526 0.38447-0.5457 0.68213-0.24805 0.29766-0.43408 0.48369-0.17363 0.18604-0.19844 0.21084zm-7.1934 7.5654q0.70694 0.06201 1.3519 0.13642 0.65732 0.06201 1.3146 0.13643 0.43408 0.03721 0.85576 0.03721 1.1782 0 2.2076-0.38447 1.0418-0.39688 1.9224-1.3146 0.02479-0.02479 0.13642-0.24805 0.11162-0.22324 0.23565-0.58291 0.12402-0.37207 0.21084-0.84336 0.08682-0.47129 0.04961-0.97978-0.02479-0.5209-0.21084-1.0294-0.18604-0.5209-0.63252-0.96738-0.62012-0.63252-1.4139-0.85576-0.79375-0.22324-1.6247-0.26045-0.86816-0.03721-1.7363-0.03721-0.62012 0-1.2278 0.01241-0.59531 0-1.2154 0-0.04961 0-0.11162 0.01241-0.04961 0.01241-0.11162 0.02479zm-0.12402-8.4088q0.57051 0 1.1286 0 0.5581-0.01241 1.1162-0.01241 0.35967 0 0.70693 0t0.70694 0.02479q0.99219 0 1.7363-0.32246 0.75654-0.33486 1.5131-0.94258 0.5457-0.43408 0.78135-0.96738 0.23565-0.5457 0.21084-1.1038-0.02479-0.55811-0.29766-1.0666-0.27285-0.5209-0.75654-0.89297-0.32246-0.24805-0.69453-0.38447-0.35967-0.13643-0.75654-0.19844-0.76894-0.13643-1.5255-0.27285-0.75654-0.14883-1.5255-0.28525-0.38447-0.06201-0.75654-0.09922-0.37207-0.03721-0.74414-0.03721-0.24805 0-0.49609 0.0248-0.24805 0.0124-0.49609 0.06201 0.03721 1.6495 0.07441 3.2494 0.03721 1.5999 0.07441 3.2246z"
                                style="
                                    fill: var(--primary-color);
                                    white-space: pre;
                                "
                            />
                            <path
                                d="m94.81 41.659q-0.13643 0.01241-0.28526 0.01241-0.13642 0.01241-0.27285 0.01241-0.85576 0-1.6247-0.24805-0.75654-0.23564-1.3891-0.84336-0.39688-0.39688-0.73174-0.84336-0.32246-0.44648-0.65732-0.89297-0.40928-0.5581-0.60772-1.1534-0.19844-0.60772-0.24805-1.2154-0.04961-0.62012 0.01241-1.2402 0.06201-0.63252 0.16123-1.265 0.13643-0.83096 0.39688-1.6123 0.27285-0.79375 0.60772-1.5751 0.24805-0.58291 0.60771-1.017 0.35967-0.44648 0.78135-0.79375 0.43408-0.34727 0.93017-0.62012 0.49609-0.27285 1.0294-0.5085 0.07441-0.03721 0.16123-0.03721 0.42168-0.02479 0.84336-0.06201 0.42168-0.03721 0.84336-0.03721 1.2526 0 2.1952 0.5209 0.94258 0.5085 1.7611 1.4387 1.327 1.5131 1.4883 3.5099 0.062 0.75654 0.14882 1.4883 0.0992 0.73174 0.0372 1.5131-0.0744 1.0046-0.5209 1.972-0.44648 0.96738-1.0542 1.7611-0.33486 0.45889-0.79375 0.79375-0.44648 0.32246-0.96738 0.5333-0.5085 0.21084-1.0666 0.31006-0.5457 0.11162-1.1038 0.11162-0.17363 0-0.34726-0.01241-0.17363 0-0.33486 0zm-3.9688-6.598q-0.08682 0.59531 0.01241 1.1534 0.09922 0.5457 0.33486 1.0666 0.24805 0.5085 0.59531 0.99219 0.34727 0.48369 0.75654 0.93018 0.40928 0.47129 0.93018 0.74414 0.5333 0.27285 1.1286 0.27285 0.47129 0 0.96738-0.18603 0.59531-0.22324 1.1534-0.5085 0.57051-0.28525 1.1534-0.5333 0.45889-0.21084 0.73174-0.5333 0.27285-0.33486 0.43408-0.79375 0.27285-0.74414 0.37207-1.4883 0.09922-0.74414 0.07441-1.4883-0.01241-0.74414-0.13642-1.4883-0.12402-0.74414-0.31006-1.4883-0.06201-0.31006-0.22324-0.50849-0.39688-0.43408-0.76894-0.79375-0.35967-0.37207-0.76895-0.63252-0.39688-0.26045-0.88056-0.40928-0.47129-0.14883-1.079-0.14883-0.40928 0-0.81856 0.04961-0.39688 0.04961-0.80615 0.08682-0.63252 0.04961-1.0418 0.34727-0.39688 0.28526-0.64492 0.78135-0.5209 1.0294-0.86816 2.1456-0.34726 1.1038-0.29766 2.4309z"
                                style="
                                    fill: var(--primary-color);
                                    white-space: pre;
                                "
                            />
                            <path
                                d="m113.62 41.274q-0.0868 0-0.17363-0.01241-0.0744-0.02479-0.13643-0.02479-0.0496 0-0.0744 0.01241-0.26045 0.07441-0.47129 0.07441-0.31006 0-0.5209-0.17363-0.21084-0.18604-0.31006-0.58291-0.0124-0.02479-0.0496-0.03721-0.0248-0.02479-0.0248-0.01241-0.65732 0.23565-1.2774 0.5085-0.62012 0.27285-1.2774 0.38447-0.74414 0.14883-1.4635 0.14883-1.0542 0-1.9968-0.37207-0.94258-0.37207-1.7239-1.265-0.44649-0.5085-0.68213-1.1782-0.22324-0.66973-0.18604-1.3767 0.0372-0.70693 0.35967-1.3767 0.32246-0.66973 0.99219-1.1906 0.75654-0.58291 1.5131-0.83096 0.76894-0.24805 1.7239-0.24805 0.85576 0.03721 1.6991 0.07441 0.84336 0.03721 1.6991 0.07441 0.0744 0 0.14883-0.01241 0.0744-0.01241 0.21084-0.02479 0.0248-0.79375-0.0496-1.5503-0.0744-0.75654-0.42168-1.4759-0.0868-0.17363-0.23564-0.33486-0.14883-0.16123-0.32246-0.24805-0.57051-0.26045-1.1534-0.44648-0.57051-0.19844-1.2154-0.19844-1.141 0-1.8852 0.55811-0.73174 0.5581-1.1038 1.6371-0.0124 0.02479-0.11162 0.14883-0.38447-0.02479-0.79375-0.03721-0.40927-0.02479-0.86816-0.04961 0.0992-0.66973 0.31006-1.2154 0.21084-0.5457 0.65732-0.97978 0.0248-0.02479 0.24805-0.29766 0.23564-0.27285 0.68213-0.60772 0.45889-0.34727 1.1286-0.64492 0.66973-0.31006 1.5627-0.37207 0.62011 0 1.2154 0.08682 0.59531 0.08682 1.1534 0.28525 0.55811 0.19844 1.0666 0.5333 0.50849 0.32246 0.95498 0.80615 0.35966 0.37207 0.5333 1.0294 0.18603 0.65732 0.27285 1.5379 0.0868 0.86816 0.11162 1.9224 0.0248 1.0542 0.0372 2.2324 0.0248 1.1658 0.0868 2.4061 0.062 1.2402 0.22325 2.4929 0 0.03721-0.0248 0.08682-0.0124 0.03721-0.0372 0.13643zm-1.972-6.0896q-0.47129-0.02479-0.88057-0.04961-0.39687-0.02479-0.79375-0.04961-0.5209-0.02479-1.0294-0.04961-0.4961-0.03721-1.0046-0.04961-1.0294 0-1.6743 0.5333-0.64492 0.5333-1.017 1.4263-0.16123 0.39688-0.17363 0.79375t0.12402 0.75654q0.13642 0.34726 0.40928 0.64492 0.27285 0.28525 0.66972 0.45889 0.22324 0.11162 0.57051 0.21084 0.34727 0.08682 0.71934 0.16123 0.38447 0.07441 0.74414 0.12402 0.35967 0.03721 0.62011 0.03721 0.73174 0 1.3767-0.23565 0.64492-0.23564 1.0418-0.80615 0.16123-0.24805 0.22324-0.5457 0.0744-0.31006 0.0868-0.68213 0.0124-0.34726 0.0248-0.71934 0.0124-0.40928 0.0124-0.75654 0.0124-0.34726 0.0124-0.68213 0-0.33486 0-0.69453 0-0.35967 0-0.78135z"
                                style="
                                    fill: var(--primary-color);
                                    white-space: pre;
                                "
                            />
                        </g>
                    </g>
                </svg>

                <span>V.1.0.0</span>
            </router-link>
        </div>

        <div class="layout-topbar-actions">
            <div class="layout-config-menu">
                <button
                    v-if="hayValoresSeleccionados"
                    type="button"
                    class="layout-topbar-action layout-topbar-action-highlight"
                    @click="visibleRight = true"
                >
                    <i class="pi pi-filter"></i>
                </button>
                <button
                    type="button"
                    class="layout-topbar-action layout-topbar-action-highlight"
                    @click="toggleDarkMode"
                >
                    <i
                        :class="[
                            'pi',
                            {
                                'pi-moon': isDarkTheme,
                                'pi-sun': !isDarkTheme
                            }
                        ]"
                    ></i>
                </button>
                <div class="relative">
                    <button
                        v-styleclass="{
                            selector: '@next',
                            enterFromClass: 'hidden',
                            enterActiveClass: 'animate-scalein',
                            leaveToClass: 'hidden',
                            leaveActiveClass: 'animate-fadeout',
                            hideOnOutsideClick: true
                        }"
                        type="button"
                        class="layout-topbar-action layout-topbar-action-highlight"
                    >
                        <i class="pi pi-palette"></i>
                    </button>
                    <AppConfigurator />
                </div>
                <button
                    type="button"
                    class="layout-topbar-action layout-topbar-action-highlight"
                    @click="toggleLegend"
                    v-tooltip.bottom="showLegend ? 'Ocultar leyenda' : 'Mostrar leyenda'"
                >
                    <i class="pi" :class="{
                        'pi-eye': showLegend,
                        'pi-eye-slash': !showLegend
                    }"></i>
                </button>
            </div>

            <div class="layout-topbar-menu hidden lg:block">
                <div class="layout-topbar-menu-content">
                    <button
                        type="button"
                        class="layout-topbar-action layout-topbar-action-highlight"
                        @click="redirigirALogin"
                    >
                        <i class="pi pi-times"></i>
                    </button>
                </div>
            </div>
        </div>
    </div>
</template>
